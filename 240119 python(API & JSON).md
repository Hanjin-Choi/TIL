# API 이해하기
> 데이터는 직접모으기는 어려우니깐 다른 데이터를 가져와야함.
간단하게 인터넷에 있는 데이터를 가져올 수 있음

## 클라이언트, 서버
서버 : 부탁을 받으면, 그대로 처리하거나 답변(값)을 줌
클라이언트 : 부탁을 하는 역할,
> 클라이언트(크롬) -> 네이버 서버 : 네이버주소를 입력하면 익히 알고 있는 네이버 메인화면을 달라고 요청합니다.
서버는 클라이언트가 요청한 네이버 메인 화면을 돌려줍니다.

* 클라이언트가 서버에 요청하는 두가지 방법
1. 웹 브라우저(크롬)을 켜서 주소창에 주소(URL)을 입력한다.(서버로 요청을 보내는 과정)
2. 서버에 정보를 요청하는 파이썬 코드를 작성(ex. request module)

서버에서 터미널 열기 (ctrl +` or 상단의 터미널 메뉴에서 New Terminal 클릭)

```py
# 서버로부터 데이터를 가져와 보세요
# https//fakestorapi.com/carts

# 서버로부터 데이터 요청 보내야함
# 보안검사도 해야함.

#이런걸 일일히 안하고 대신해주는것이 라이브러리
# 라이브러리 : 남들이 만들어놓은 코드를 가져다 쓰자
# 데이터를 가져오는 python 라이브러리(패키지) : requests
# 파이썬 패키지 관리 : pip
    # 설치 : pip install <패키지이름>
    # 목록 확인 : pip list
import requests

URL = 'https://fakestoreapi.com/carts'
response = requests.get(URL)
parsed_data = response.json()
print(parsed_data)
```
* URL : 요청을 보내는 서버의 주소

* .json()
내부의 데이터를 JSON(파이썬 딕셔너리와 비슷함)형태로 변환해주는 함수

# API
* 클라이언트가 원하는 기능을 수행하기 위해서 서버 측에 만들어 놓은 프로그램
    * 기능 예시 : 데이터 저장, 조회, 수정, 삭제 등등
* 서버 측에 특정 주소로 요청이 오면 정해진 기능을 수행하는 API를 미리 만들어 둠.
    * 클라이언트는 서버가 미리 만들어 놓은 주소로 요청을 보냄

## 오픈API
* 외부에서 사용할 수 있도록 무료로 개방된 API
* 사용법은 공식문서(Docs)에 명시되어 있음
* 대표적인 오픈 API
    * OpenWeatherMap API : 기상 데이터 및 날씨 정보를 제공하는 오픈 API
    * 금융상품통합비교공시 API : 금융감독원에서 제공하는 금융 상품 정보를 제공하는 오픈 API
### 오픈API 특징 및 주의사항
* 악성 사용자가 100만개의 계정을 생성해 API에 요청을 보내는 상황이 생기면 너무 많은 계정에서 동시에 요청을 보내면 서버가 견디지 못함
* 이러한 문제점을 해결하기 위해 오픈API는 API KEY를 활용하여 사용자를 확인
    * 사용자 인증 혹은 회원가입을 하면 서버에서 API Key를 발급함
    * 서버에 요청할 때마다 해당 API KEY를 함께 보내 정상적인 사용자인 것을 확인 받음
* API KEY를 가지고 있는 악성 사용자가 1초에 100만 개의 요청을 보내는 상황이면 서버가 견디지 못할것 -> 일부 오픈 API는 사용량이 제한되어있음
    * 공식문서의 일일 및 월간 사용량 제한을 반드시 확인해볼것
    * 초과시 요금이 청구될 가능성이 높음

## JSON
API가 반환하는 데이터 형태
* JavaScript Object Notation의 약자. 직역하면 '자바스크립트 객체 표기법'
* 데이터를 저장하거나 전송할 때 많이 사용되는 경량의 텍스트 기반의 데이터 형식
* 통신 방법이나 프로그래밍 문법이 아니라 단순히 데이터를 표현하는 표현 방법 중 하나
* 특징
    * 데이터는 중괄호{}로 둘러싸인 키-값 쌍의 집합으로 표현됨
    * 키 = 문자열/ 값 = 다양한 데이터 유형을 가질 수 있다.
    * 값은 쉼표(,)로 구분됨

* 파싱(Parsing) : 데이터를 의미 있는 구조로 분석하고 해석하는 과정
* json.loads(): JSON 형식의 문자열을 파싱하여 python Dictionary로 변환
```py
import requests
import pprint
API_key = '09a33b5c0e' #이런 형식의 키를 넣어야 데이터를 받아 올 수 있음
# 실제 키가 아니니 다시 해보려면 키를 확인해야함
# 서울의 위도
lat = 37.56
# 서울의 경도
lon = 126.97


URL = f'https://api.openweathermap.org/data/2.5/weather?lat={lat}&lon={lon}&appid={API_key}'
response = requests.get(URL)
parsed_data = response.json()
pprint.pprint(parsed_data['weather'][0]['description'])
```